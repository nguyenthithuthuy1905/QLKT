@* Form Nhập MSSV và tự động điền thông tin *@
<form asp-action="ThemCamDoan" asp-controller="CamDoan" asp-area="Admin" method="post">
    <div class="form-group">
        <label for="masv">Mã số sinh viên</label>
        <input type="text" id="masv" name="maSinhVien" class="form-control" placeholder="Nhập MSSV" required />
    </div>

    <div class="form-group">
        <label for="hoten">Họ và tên</label>
        <input type="text" id="hoten" class="form-control" disabled />
    </div>
    <div class="form-group">
        <label for="lop">Lớp</label>
        <input type="text" id="lop" class="form-control" disabled />
    </div>
    <div class="form-group">
        <label for="ngaythi">Ngày thi</label>
        <input type="text" id="ngaythi" class="form-control" disabled />
    </div>
    <div class="form-group">
        <label for="giothi">Giờ thi</label>
        <input type="text" id="giothi" class="form-control" disabled />
    </div>
    <div class="form-group">
        <label for="phongthi">Phòng thi</label>
        <input type="text" id="phongthi" class="form-control" disabled />
    </div>
    <div class="form-group">
        <label for="monhoc">Môn học</label>
        <input type="text" id="monhoc" class="form-control" disabled />
    </div>
    <div class="form-group">
        <label>Nội dung:</label>
        <textarea name="NoiDungCamDoan" class="form-control" required></textarea>
    </div>

    <button type="submit" class="btn btn-success" onclick="return confirmSave()">Lưu thông tin</button>

</form>


<script>
        document.getElementById("masv").addEventListener("change", function () {
        const masv = this.value.trim();
        if (masv === "") return;

        // Mã hóa mã số sinh viên để tránh lỗi URI
        const encodedMaSV = encodeURIComponent(masv);

        fetch(`/CamDoan/GetStudentInfo?maSV=${encodedMaSV}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Không tìm thấy dữ liệu lịch thi!");
                }
                return response.json();
            })
            .then(data => {
                console.log("Dữ liệu API trả về:", data);

                if (data && !data.error) {
                    document.getElementById("hoten").value = data.hoTen || "Không có tên";
                    document.getElementById("lop").value = data.maLop || "Không có lớp";
                    document.getElementById("ngaythi").value = data.ngayThi || "Không có ngày thi";
                    document.getElementById("giothi").value = data.gioThi || "Không có giờ thi";
                    document.getElementById("phongthi").value = data.phongThi || "Không có phòng thi";
                    document.getElementById("monhoc").value = data.tenMonHoc || "Không có môn học";
                } else {
                    alert("Không tìm thấy thông tin sinh viên!");
                    // Clear fields if no data found
                    document.getElementById("hoten").value = "";
                    document.getElementById("lop").value = "";
                    document.getElementById("ngaythi").value = "";
                    document.getElementById("giothi").value = "";
                    document.getElementById("phongthi").value = "";
                    document.getElementById("monhoc").value = "";
                }
            })
            .catch(error => {
                console.error("Lỗi:", error);
                alert("Không tìm thấy lịch thi!");
            });
    });

</script>

<script type="text/javascript">
    function confirmSave() {
        // Hiển thị hộp thoại xác nhận
        var result = confirm("Bạn có chắc chắn muốn lưu thông tin không?");
        // Nếu người dùng chọn OK, thì form sẽ được gửi
        if (result) {
            return true;  // Form sẽ được submit
        }
        // Nếu người dùng chọn Cancel, form sẽ không được gửi
        return false;
    }
</script>


<script type="text/javascript">
    function confirmSave() {
        // Hiển thị hộp thoại xác nhận
        var result = confirm("Bạn có chắc chắn muốn lưu thông tin không?");
        if (result) {
            return true;  // Form sẽ được submit
        }
        return false;  // Ngừng gửi form
    }
</script>
